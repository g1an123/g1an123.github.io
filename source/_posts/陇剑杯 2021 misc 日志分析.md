---
title: 陇剑杯 2021 misc 日志分析
date: 2023-08-24 12:34:19
tags:
- misc
- 日志分析
categories:
- ctf
- writeup
---
## 陇剑杯 2021 日志分析（问1）
```
题目描述：

单位某应用程序被攻击，请分析日志，进行作答：
网络存在源码泄漏，源码文件名是_____________。(请提交带有文件后缀的文件名，例如x.txt)。得到的flag请使用NSSCTF{}格式提交。
```
打开日志文件，不知道用哪个软件比较好分析，还请各位大佬指点。
我直接用vscode打开看看
![](https://cdn.jsdelivr.net/gh/g1an123/blogimage@main/%E6%88%AA%E5%B1%8F2023-08-24%2012.39.08.png)
发现主要信息集中于请求路径和状态码。
大部分都是404，直接全局搜索200看看

大概下半段就可以看到请求www.zip时为200.
下班！

## 陇剑杯 2021 日志分析（问2）
```
题目描述：

单位某应用程序被攻击，请分析日志，进行作答：
分析攻击流量，黑客往/tmp目录写入一个文件，文件名为_____________。得到的flag请使用NSSCTF{}格式提交。
```
![](https://cdn.jsdelivr.net/gh/g1an123/blogimage@main/%E6%88%AA%E5%B1%8F2023-08-24%2012.46.43.png)
全局搜索一下tmp，发现有
`/?filename=..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Ftmp%2Fsess_car&content=func%7CN%3Bfiles%7Ca%3A2%3A%7Bs%3A8%3A%22filename%22%3Bs%3A16%3A%22.%2Ffiles%2Ffilename%22%3Bs%3A20%3A%22call_user_func_array%22%3Bs%3A28%3A%22.%2Ffiles%2Fcall_user_func_array%22%3B%7Dpaths%7Ca%3A1%3A%7Bs%3A5%3A%22%2Fflag%22%3Bs%3A13%3A%22SplFileObject%22%3B%7D`
解一下码好看一点。
`/?filename=../../../../../../../../../../../../../../../../../tmp/sess_car&content=func|N;files|a:2:{s:8:"filename";s:16:"./files/filename";s:20:"call_user_func_array";s:28:"./files/call_user_func_array";}paths|a:1:{s:5:"/flag";s:13:"SplFileObject";}`

得到sess_car.


## 陇剑杯 2021 日志分析（问3）
```
题目描述：

单位某应用程序被攻击，请分析日志，进行作答：
分析攻击流量，黑客使用的是______类读取了秘密文件。得到的flag请使用NSSCTF{}格式提交。
```
上一题中解码出来的payload就能看出时SplFileObject类进行读取。